<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Time-Series Plots | Cooking with Cal-Adapt Climate Data in R</title>
  <meta name="description" content="Chapter 3 Time-Series Plots | Cooking with Cal-Adapt Climate Data in R" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Time-Series Plots | Cooking with Cal-Adapt Climate Data in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://ucanr-igis.github.io/ca_cookbook//./images/cookbook-cover_640x480.jpg" />
  
  <meta name="github-repo" content="ucanr-igis/ca_cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Time-Series Plots | Cooking with Cal-Adapt Climate Data in R" />
  
  
  <meta name="twitter:image" content="https://ucanr-igis.github.io/ca_cookbook//./images/cookbook-cover_640x480.jpg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="02_api-requests.html"/>
<link rel="next" href="04_metrics-methods.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.0.9000/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.0.9000/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Cooking with Cal-Adapt</strong></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#general-workflow"><i class="fa fa-check"></i><b>1.1</b> General Workflow<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#using-climate-data-wisely"><i class="fa fa-check"></i><b>1.2</b> Using Climate Data Wisely<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#video-overviews"><i class="fa fa-check"></i><b>1.3</b> Video Overviews<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02_api-requests.html"><a href="02_api-requests.html"><i class="fa fa-check"></i><b>2</b> API Requests<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="02_api-requests.html"><a href="02_api-requests.html#constructing-cal-adapt-api-requests"><i class="fa fa-check"></i><b>2.1</b> Constructing Cal-Adapt API Requests<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="02_api-requests.html"><a href="02_api-requests.html#checking-an-api-request"><i class="fa fa-check"></i><b>2.2</b> Checking an API Request<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="02_api-requests.html"><a href="02_api-requests.html#locations-of-interest"><i class="fa fa-check"></i><b>2.3</b> Locations of Interest<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="02_api-requests.html"><a href="02_api-requests.html#longitude-latitude-coordinates"><i class="fa fa-check"></i><b>2.3.1</b> Longitude-Latitude Coordinates<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="02_api-requests.html"><a href="02_api-requests.html#simple-feature-data-frame"><i class="fa fa-check"></i><b>2.3.2</b> Simple Feature Data Frame<span></span></a></li>
<li class="chapter" data-level="2.3.3" data-path="02_api-requests.html"><a href="02_api-requests.html#preset-area-of-interest"><i class="fa fa-check"></i><b>2.3.3</b> Preset Area of Interest<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html"><i class="fa fa-check"></i><b>3</b> Time-Series Plots<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#load-packages"><i class="fa fa-check"></i><b>3.1</b> Load Packages<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#time-series-plots-1"><i class="fa fa-check"></i><b>3.2</b> Time Series Plots<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#fetch-some-data"><i class="fa fa-check"></i><b>3.2.1</b> Fetch Some Data<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#plot-1.-single-climate-variable-single-rcp"><i class="fa fa-check"></i><b>3.2.2</b> Plot 1. Single Climate Variable &amp; Single RCP<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#multiple-emissions-scenarios"><i class="fa fa-check"></i><b>3.3</b> Multiple Emissions Scenarios<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#overlay-a-trend-line"><i class="fa fa-check"></i><b>3.4</b> Overlay a Trend Line<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#historic-and-future-data-together"><i class="fa fa-check"></i><b>3.5</b> Historic and Future Data Together<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#overlay-a-32-model-ensemble"><i class="fa fa-check"></i><b>3.6</b> Overlay a 32-model Ensemble<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#visualize-variability-with-histograms"><i class="fa fa-check"></i><b>3.7</b> Visualize Variability with Histograms<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html"><i class="fa fa-check"></i><b>4</b> Methods for Computing Climate Metrics<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#load-packages-1"><i class="fa fa-check"></i><b>4.1</b> Load packages<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#fetch-some-sample-data"><i class="fa fa-check"></i><b>4.2</b> Fetch Some Sample Data<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#time-slicing"><i class="fa fa-check"></i><b>4.3</b> Time Slicing<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#daily-climate-metrics"><i class="fa fa-check"></i><b>4.4</b> Daily Climate Metrics<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#diurnal-temperature-range"><i class="fa fa-check"></i><b>4.5</b> Diurnal Temperature Range<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#daily-threshhold-events"><i class="fa fa-check"></i><b>4.6</b> Daily Threshhold Events<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#counting-consecutive-events"><i class="fa fa-check"></i><b>4.7</b> Counting Consecutive Events<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html"><i class="fa fa-check"></i><b>5</b> AgroClimate Metrics<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#load-packages-2"><i class="fa fa-check"></i><b>5.1</b> Load Packages<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#fetch-some-data-1"><i class="fa fa-check"></i><b>5.2</b> Fetch Some Data<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#growing-degree-days"><i class="fa fa-check"></i><b>5.3</b> Growing Degree Days<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#chill-accumulation"><i class="fa fa-check"></i><b>5.4</b> Chill Accumulation<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#frost-days"><i class="fa fa-check"></i><b>5.5</b> Frost Days<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#last-spring-and-first-fall-freeze"><i class="fa fa-check"></i><b>5.6</b> Last Spring and First Fall Freeze<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#freeze-free-season"><i class="fa fa-check"></i><b>5.7</b> Freeze-Free Season<span></span></a></li>
<li class="chapter" data-level="5.8" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#tropical-nights-and-hot-days"><i class="fa fa-check"></i><b>5.8</b> Tropical Nights and Hot Days<span></span></a></li>
<li class="chapter" data-level="5.9" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#extreme-heat-days"><i class="fa fa-check"></i><b>5.9</b> Extreme Heat Days<span></span></a></li>
<li class="chapter" data-level="5.10" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#heatwaves"><i class="fa fa-check"></i><b>5.10</b> Heatwaves<span></span></a></li>
<li class="chapter" data-level="5.11" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#diurnal-temperature-range-1"><i class="fa fa-check"></i><b>5.11</b> Diurnal Temperature Range<span></span></a></li>
<li class="chapter" data-level="5.12" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#reference-evapotranspiration"><i class="fa fa-check"></i><b>5.12</b> Reference Evapotranspiration<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06_degday.html"><a href="06_degday.html"><i class="fa fa-check"></i><b>6</b> Degree Days<span></span></a></li>
<li class="chapter" data-level="7" data-path="07_joining-other-data.html"><a href="07_joining-other-data.html"><i class="fa fa-check"></i><b>7</b> Joining Other Tables<span></span></a></li>
<li class="chapter" data-level="8" data-path="08_raster-analyses.html"><a href="08_raster-analyses.html"><i class="fa fa-check"></i><b>8</b> Raster Operations<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="08_raster-analyses.html"><a href="08_raster-analyses.html#load-packages-3"><i class="fa fa-check"></i><b>8.1</b> Load Packages<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="08_raster-analyses.html"><a href="08_raster-analyses.html#fetch-tifs"><i class="fa fa-check"></i><b>8.2</b> Fetch TIFs<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="08_raster-analyses.html"><a href="08_raster-analyses.html#import-tifs-in-r"><i class="fa fa-check"></i><b>8.3</b> Import TIFs in R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09_shiny.html"><a href="09_shiny.html"><i class="fa fa-check"></i><b>9</b> Shiny Apps<span></span></a></li>
<li class="chapter" data-level="10" data-path="99_references.html"><a href="99_references.html"><i class="fa fa-check"></i><b>10</b> References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cooking with Cal-Adapt Climate Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-plots" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Time-Series Plots<a href="03_time-series-viz.html#time-series-plots" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter we’ll look at how to make some time series plots with Cal-Adapt data.</p>
<div id="load-packages" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Load Packages<a href="03_time-series-viz.html#load-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As always, begin by loading a bunch of packages into memory and specifying preferences for conflicting function names.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="03_time-series-viz.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caladaptr)</span>
<span id="cb26-2"><a href="03_time-series-viz.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(units)</span>
<span id="cb26-3"><a href="03_time-series-viz.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-4"><a href="03_time-series-viz.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb26-5"><a href="03_time-series-viz.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb26-6"><a href="03_time-series-viz.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb26-7"><a href="03_time-series-viz.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<p>Set conflicted preferences:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="03_time-series-viz.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb27-2"><a href="03_time-series-viz.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">&quot;filter&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-3"><a href="03_time-series-viz.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">&quot;count&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-4"><a href="03_time-series-viz.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">&quot;select&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="time-series-plots-1" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Time Series Plots<a href="03_time-series-viz.html#time-series-plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section our goal is to create <strong>time series plot</strong> of projected maximum annual temperature for a <strong>single point</strong>, using the <strong>four recommended GCMs</strong> for California under RCP 4.5.</p>
<p><img src="images/ch2_time-series_580x400x256.png" style="display:block; width:580px; height:400px; margin:1em auto; border:none;" /></p>
<div id="fetch-some-data" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Fetch Some Data<a href="03_time-series-viz.html#fetch-some-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First we create an API request object that will ask the Cal-Adapt API to send back data for:</p>
<ul>
<li>maximum daily temperature, averaged by year (on the server)<br />
</li>
<li>a point location (outside Salinas, CA)<br />
</li>
<li>the first four CGMs (HadGEM2-ES, CNRM-CM5, CanESM2, MIROC5 - the four ‘priority’ models recommended for California under the 4th Climate Change Assessment)<br />
</li>
<li>two emissions scenarios (rcp45 and rcp85)</li>
<li>the time period 2006-2099</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="03_time-series-viz.html#cb28-1" aria-hidden="true" tabindex="-1"></a>salns_cap <span class="ot">&lt;-</span> <span class="fu">ca_loc_pt</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">121.549945</span>, <span class="fl">36.643642</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="03_time-series-viz.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_gcm</span>(gcms[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">%&gt;%</span>                                 </span>
<span id="cb28-3"><a href="03_time-series-viz.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_scenario</span>(<span class="fu">c</span>(<span class="st">&quot;rcp45&quot;</span>, <span class="st">&quot;rcp85&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="03_time-series-viz.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_period</span>(<span class="st">&quot;year&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="03_time-series-viz.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_years</span>(<span class="at">start =</span> <span class="dv">2006</span>, <span class="at">end =</span> <span class="dv">2099</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="03_time-series-viz.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_cvar</span>(<span class="fu">c</span>(<span class="st">&quot;tasmin&quot;</span>, <span class="st">&quot;tasmax&quot;</span>))</span></code></pre></div>
<p>Check the API request for issues:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="03_time-series-viz.html#cb29-1" aria-hidden="true" tabindex="-1"></a>salns_cap <span class="sc">%&gt;%</span> <span class="fu">ca_preflight</span>()</span></code></pre></div>
<pre><code>## General issues
##  - none found
## Issues for querying values
##  - none found
## Issues for downloading rasters
##  - none found</code></pre>
<p>Fetch data:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="03_time-series-viz.html#cb31-1" aria-hidden="true" tabindex="-1"></a>salns_tbl <span class="ot">&lt;-</span> salns_cap <span class="sc">%&gt;%</span> <span class="fu">ca_getvals_tbl</span>(<span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="03_time-series-viz.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(salns_tbl)</span></code></pre></div>
<pre><code>## Rows: 1,280
## Columns: 8
## $ id       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1~
## $ cvar     &lt;fct&gt; tasmin, tasmin, tasmin, tasmin, tasmin, tasmin, tasmin, tasmi~
## $ period   &lt;fct&gt; year, year, year, year, year, year, year, year, year, year, y~
## $ gcm      &lt;fct&gt; HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, H~
## $ scenario &lt;fct&gt; rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45~
## $ spag     &lt;fct&gt; none, none, none, none, none, none, none, none, none, none, n~
## $ dt       &lt;chr&gt; &quot;2020-12-31&quot;, &quot;2021-12-31&quot;, &quot;2022-12-31&quot;, &quot;2023-12-31&quot;, &quot;2024~
## $ val      [K] 281.5107 [K], 281.1210 [K], 282.2193 [K], 281.9851 [K], 281.815~</code></pre>
<p>The <code>val</code> column contains the temperature values with the units recorded (i.e., a units object from the <code>units</code> package). But Kelvin is not very intuitive. Let’s add a column with the temperatures in Fahrenheit. Because we already have the temperature values as a units object, we can convert them with <code>units::set_units()</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="03_time-series-viz.html#cb34-1" aria-hidden="true" tabindex="-1"></a>salns_degf_tbl <span class="ot">&lt;-</span> salns_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="03_time-series-viz.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_f =</span> units<span class="sc">::</span><span class="fu">set_units</span>(val, degF))</span>
<span id="cb34-3"><a href="03_time-series-viz.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="03_time-series-viz.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(salns_degf_tbl)</span></code></pre></div>
<pre><code>## Rows: 1,280
## Columns: 9
## $ id       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1~
## $ cvar     &lt;fct&gt; tasmin, tasmin, tasmin, tasmin, tasmin, tasmin, tasmin, tasmi~
## $ period   &lt;fct&gt; year, year, year, year, year, year, year, year, year, year, y~
## $ gcm      &lt;fct&gt; HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, H~
## $ scenario &lt;fct&gt; rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45~
## $ spag     &lt;fct&gt; none, none, none, none, none, none, none, none, none, none, n~
## $ dt       &lt;chr&gt; &quot;2020-12-31&quot;, &quot;2021-12-31&quot;, &quot;2022-12-31&quot;, &quot;2023-12-31&quot;, &quot;2024~
## $ val      [K] 281.5107 [K], 281.1210 [K], 282.2193 [K], 281.9851 [K], 281.815~
## $ temp_f   [degF] 47.04928 [degF], 46.34775 [degF], 48.32468 [degF], 47.90319 ~</code></pre>
<p><br />
</p>
</div>
<div id="plot-1.-single-climate-variable-single-rcp" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Plot 1. Single Climate Variable &amp; Single RCP<a href="03_time-series-viz.html#plot-1.-single-climate-variable-single-rcp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our table has a lot of data combined: two climate variables, four GCMs, and two emissions scenarios. Each combo of those variables constitutes a time series, so we have 16 time series in total.</p>
<p>We’ll start by plotting just a single time series (one climate variable, one GCM, one scenario). Because our table is in ‘long’ format, we can easily filter it with <code>dplyr::filter()</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="03_time-series-viz.html#cb36-1" aria-hidden="true" tabindex="-1"></a>single_series_tbl <span class="ot">&lt;-</span> salns_degf_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="03_time-series-viz.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tasmax&quot;</span>, gcm <span class="sc">==</span> <span class="st">&quot;HadGEM2-ES&quot;</span>, scenario <span class="sc">==</span> <span class="st">&quot;rcp45&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="03_time-series-viz.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt, cvar, gcm, scenario, period, temp_f)</span>
<span id="cb36-4"><a href="03_time-series-viz.html#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="03_time-series-viz.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(single_series_tbl)</span></code></pre></div>
<pre><code>## Rows: 80
## Columns: 6
## $ dt       &lt;chr&gt; &quot;2020-12-31&quot;, &quot;2021-12-31&quot;, &quot;2022-12-31&quot;, &quot;2023-12-31&quot;, &quot;2024~
## $ cvar     &lt;fct&gt; tasmax, tasmax, tasmax, tasmax, tasmax, tasmax, tasmax, tasma~
## $ gcm      &lt;fct&gt; HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, HadGEM2-ES, H~
## $ scenario &lt;fct&gt; rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45, rcp45~
## $ period   &lt;fct&gt; year, year, year, year, year, year, year, year, year, year, y~
## $ temp_f   [degF] 67.86865 [degF], 69.67442 [degF], 69.38894 [degF], 68.93449 ~</code></pre>
<p><br />
</p>
<p>Plot with ggplot:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="03_time-series-viz.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> single_series_tbl, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(dt), <span class="at">y =</span> <span class="fu">as.numeric</span>(temp_f))) <span class="sc">+</span></span>
<span id="cb38-2"><a href="03_time-series-viz.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb38-3"><a href="03_time-series-viz.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted Maximum Daily Temperature Averaged by Year&quot;</span>,</span>
<span id="cb38-4"><a href="03_time-series-viz.html#cb38-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Location: Salinas, CA. GCM: HadGEM2-ES; Emissions scenario: RCP4.5&quot;</span>, </span>
<span id="cb38-5"><a href="03_time-series-viz.html#cb38-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;temp (F)&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/plot_single_series_tbl-1.png" width="672" /></p>
<p><br />
</p>
<p>If you want to plot multiple GCMs, you can differentiate them with colors. ggplot makes this easy, and will even create a legend for you. But although we can easily add lots of lines to a plot, it makes to sense to limit each plot to a single climate variables and a single emissions scenario.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="03_time-series-viz.html#cb39-1" aria-hidden="true" tabindex="-1"></a>mult_gcm_tbl <span class="ot">&lt;-</span> salns_degf_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="03_time-series-viz.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tasmax&quot;</span>, scenario <span class="sc">==</span> <span class="st">&quot;rcp45&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="03_time-series-viz.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt, gcm, temp_f)</span>
<span id="cb39-4"><a href="03_time-series-viz.html#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="03_time-series-viz.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mult_gcm_tbl, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(dt), <span class="at">y =</span> <span class="fu">as.numeric</span>(temp_f))) <span class="sc">+</span></span>
<span id="cb39-6"><a href="03_time-series-viz.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>gcm)) <span class="sc">+</span></span>
<span id="cb39-7"><a href="03_time-series-viz.html#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted Maximum Daily Temperature Averaged by Year&quot;</span>,</span>
<span id="cb39-8"><a href="03_time-series-viz.html#cb39-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Location: Salinas, CA. Emissions scenario: RCP4.5&quot;</span>, </span>
<span id="cb39-9"><a href="03_time-series-viz.html#cb39-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;temp (F)&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/plot_mult_series_tbl-1.png" width="672" /></p>
<p><br />
</p>
</div>
</div>
<div id="multiple-emissions-scenarios" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Multiple Emissions Scenarios<a href="03_time-series-viz.html#multiple-emissions-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To plot multiple emissions scenarios, you probably want to use facets:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="03_time-series-viz.html#cb40-1" aria-hidden="true" tabindex="-1"></a>mult_scen_tbl <span class="ot">&lt;-</span> salns_degf_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="03_time-series-viz.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tasmax&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="03_time-series-viz.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt, gcm, scenario, temp_f)</span>
<span id="cb40-4"><a href="03_time-series-viz.html#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="03_time-series-viz.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mult_scen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(dt), <span class="at">y =</span> <span class="fu">as.numeric</span>(temp_f))) <span class="sc">+</span></span>
<span id="cb40-6"><a href="03_time-series-viz.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>gcm)) <span class="sc">+</span></span>
<span id="cb40-7"><a href="03_time-series-viz.html#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(scenario <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb40-8"><a href="03_time-series-viz.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted Maximum Daily Temperature Averaged by Year&quot;</span>,</span>
<span id="cb40-9"><a href="03_time-series-viz.html#cb40-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Location: Salinas, CA&quot;</span>, </span>
<span id="cb40-10"><a href="03_time-series-viz.html#cb40-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;temp (F)&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><br />
</p>
</div>
<div id="overlay-a-trend-line" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Overlay a Trend Line<a href="03_time-series-viz.html#overlay-a-trend-line" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ggplot can add a trend line for you (by adding <code>geom_smooth</code>), but you have to decide whether you want a trend line for each individual GCM, or perhaps all GCMs in the same emissions scenario. Below we overlay a trend line for each emissions scenario.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="03_time-series-viz.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mult_scen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(dt), <span class="at">y =</span> <span class="fu">as.numeric</span>(temp_f))) <span class="sc">+</span></span>
<span id="cb41-2"><a href="03_time-series-viz.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>gcm)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="03_time-series-viz.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="03_time-series-viz.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(scenario <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb41-5"><a href="03_time-series-viz.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted Maximum Daily Temperature Averaged by Year&quot;</span>,</span>
<span id="cb41-6"><a href="03_time-series-viz.html#cb41-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Location: Salinas, CA&quot;</span>, </span>
<span id="cb41-7"><a href="03_time-series-viz.html#cb41-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;temp (F)&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><br />
</p>
</div>
<div id="historic-and-future-data-together" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Historic and Future Data Together<a href="03_time-series-viz.html#historic-and-future-data-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many studies on the impact of climate change look at the past as a reference for future climate conditions. Here we’ll create a time series plot that goes all the way back to 1950.</p>
<p>The first question you have to ask is <em>what data should I use for the historic period?</em>. Your first reaction might be to use observed historic data (i.e., from weather stations). You can certainly do that, as the Cal-Adapt API has both the Livneh and gridMet datasets (both of which are observed data interpolated from weather stations).</p>
<p>However we don’t have observed data for the future. This presents a problem because comparing observed past data with modeled future data is like comparing apples and oranges. They represent different things.</p>
<p>A better option is to compare the modeled future climate with a modeled historic climate. This may seem counter-intuitive, but the climate models have been trained from historic data, and have been shown to do a very good job at capturing the climate envelope of the past.</p>
<p>First we need to get the historic modeled data, for the same climate variable, GCMs, and location. caladaptR has no problem combining multiple datasets in the same API call, however in this case we need to make a separate API call for the historic data because the dates are different.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="03_time-series-viz.html#cb42-1" aria-hidden="true" tabindex="-1"></a>salns_hist_cap <span class="ot">&lt;-</span> <span class="fu">ca_loc_pt</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">121.549945</span>, <span class="fl">36.643642</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="03_time-series-viz.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_gcm</span>(gcms[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="03_time-series-viz.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_scenario</span>(<span class="st">&quot;historical&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="03_time-series-viz.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_period</span>(<span class="st">&quot;year&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="03_time-series-viz.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_years</span>(<span class="at">start =</span> <span class="dv">1950</span>, <span class="at">end =</span> <span class="dv">2005</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="03_time-series-viz.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_cvar</span>(<span class="fu">c</span>(<span class="st">&quot;tasmin&quot;</span>, <span class="st">&quot;tasmax&quot;</span>))</span>
<span id="cb42-7"><a href="03_time-series-viz.html#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="03_time-series-viz.html#cb42-8" aria-hidden="true" tabindex="-1"></a>salns_hist_cap <span class="sc">%&gt;%</span> <span class="fu">ca_preflight</span>()</span></code></pre></div>
<pre><code>## General issues
##  - none found
## Issues for querying values
##  - none found
## Issues for downloading rasters
##  - none found</code></pre>
<p><br />
</p>
<p>Next we get the values. While we’re at it, we can add the column for degrees Fahrenheit:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="03_time-series-viz.html#cb44-1" aria-hidden="true" tabindex="-1"></a>salns_hist_tbl <span class="ot">&lt;-</span> salns_hist_cap <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="03_time-series-viz.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_getvals_tbl</span>(<span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="03_time-series-viz.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_f =</span> units<span class="sc">::</span><span class="fu">set_units</span>(val, degF))</span>
<span id="cb44-4"><a href="03_time-series-viz.html#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="03_time-series-viz.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(salns_hist_tbl)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##      id cvar   period gcm        scenario   spag  dt          val temp_f
##   &lt;int&gt; &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;      &lt;fct&gt;      &lt;fct&gt; &lt;chr&gt;       [K] [degF]
## 1     1 tasmin year   HadGEM2-ES historical none  1950-12-31 280.   45.0
## 2     1 tasmin year   HadGEM2-ES historical none  1951-12-31 280.   44.9
## 3     1 tasmin year   HadGEM2-ES historical none  1952-12-31 282.   47.6
## 4     1 tasmin year   HadGEM2-ES historical none  1953-12-31 282.   48.1
## 5     1 tasmin year   HadGEM2-ES historical none  1954-12-31 281.   46.9
## 6     1 tasmin year   HadGEM2-ES historical none  1955-12-31 281.   46.0</code></pre>
<p><br />
</p>
<p>Our tibbles for the past and future time periods have identical columns, so we can stack them. While we’re at it, we can convert the dt column from character to Date:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="03_time-series-viz.html#cb46-1" aria-hidden="true" tabindex="-1"></a>salns_all_tbl <span class="ot">&lt;-</span> salns_degf_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="03_time-series-viz.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(salns_hist_tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="03_time-series-viz.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dt =</span> <span class="fu">as.Date</span>(dt))</span>
<span id="cb46-4"><a href="03_time-series-viz.html#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="03_time-series-viz.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(salns_all_tbl)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 9
##      id cvar   period gcm        scenario spag  dt          val temp_f
##   &lt;int&gt; &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;      &lt;fct&gt;    &lt;fct&gt; &lt;date&gt;      [K] [degF]
## 1     1 tasmin year   HadGEM2-ES rcp45    none  2020-12-31 282.   47.0
## 2     1 tasmin year   HadGEM2-ES rcp45    none  2021-12-31 281.   46.3
## 3     1 tasmin year   HadGEM2-ES rcp45    none  2022-12-31 282.   48.3
## 4     1 tasmin year   HadGEM2-ES rcp45    none  2023-12-31 282.   47.9
## 5     1 tasmin year   HadGEM2-ES rcp45    none  2024-12-31 282.   47.6
## 6     1 tasmin year   HadGEM2-ES rcp45    none  2025-12-31 282.   47.5</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="03_time-series-viz.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(salns_all_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(cvar, gcm, scenario, dt, temp_f))</span></code></pre></div>
<pre><code>##      cvar             gcm            scenario         dt            
##  tasmax:864   CanESM2   :432   rcp45     :640   Min.   :1950-12-31  
##  tasmin:864   CNRM-CM5  :432   rcp85     :640   1st Qu.:2004-09-30  
##               HadGEM2-ES:432   historical:448   Median :2046-07-01  
##               MIROC5    :432                    Mean   :2039-03-29  
##                                                 3rd Qu.:2073-04-01  
##                                                 Max.   :2099-12-31  
##      temp_f     
##  Min.   :43.99  
##  1st Qu.:48.73  
##  Median :60.94  
##  Mean   :59.49  
##  3rd Qu.:69.99  
##  Max.   :78.35</code></pre>
<p><br />
</p>
<p>To plot the time series from 1950 thru 2099, we have to pick one of the future scenarios.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="03_time-series-viz.html#cb50-1" aria-hidden="true" tabindex="-1"></a>salns_histrcp45_tbl <span class="ot">&lt;-</span> salns_all_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="03_time-series-viz.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tasmax&quot;</span>, scenario <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;historical&quot;</span>, <span class="st">&quot;rcp45&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="03_time-series-viz.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt, gcm, temp_f)</span>
<span id="cb50-4"><a href="03_time-series-viz.html#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="03_time-series-viz.html#cb50-5" aria-hidden="true" tabindex="-1"></a>salns_histrcp45_tbl</span></code></pre></div>
<pre><code>## # A tibble: 544 x 3
##    dt         gcm        temp_f
##    &lt;date&gt;     &lt;fct&gt;      [degF]
##  1 2020-12-31 HadGEM2-ES   67.9
##  2 2021-12-31 HadGEM2-ES   69.7
##  3 2022-12-31 HadGEM2-ES   69.4
##  4 2023-12-31 HadGEM2-ES   68.9
##  5 2024-12-31 HadGEM2-ES   68.7
##  6 2025-12-31 HadGEM2-ES   69.6
##  7 2026-12-31 HadGEM2-ES   68.9
##  8 2027-12-31 HadGEM2-ES   70.1
##  9 2028-12-31 HadGEM2-ES   67.3
## 10 2029-12-31 HadGEM2-ES   67.6
## # ... with 534 more rows</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="03_time-series-viz.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> salns_histrcp45_tbl, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(dt), <span class="at">y =</span> <span class="fu">as.numeric</span>(temp_f))) <span class="sc">+</span></span>
<span id="cb52-2"><a href="03_time-series-viz.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>gcm)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="03_time-series-viz.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted Maximum Daily Temperature Averaged by Year&quot;</span>,</span>
<span id="cb52-4"><a href="03_time-series-viz.html#cb52-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Location: Salinas, CA. Emissions scenarios: Historical (1950-2005), RCP4.5 (2006-2099)&quot;</span>, </span>
<span id="cb52-5"><a href="03_time-series-viz.html#cb52-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;temp (F)&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p><br />
</p>
</div>
<div id="overlay-a-32-model-ensemble" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Overlay a 32-model Ensemble<a href="03_time-series-viz.html#overlay-a-32-model-ensemble" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the examples above, we plotted the 4 ‘priority’ GCMs out of the 10 recommended GCMs for California. But there are 22 other GCMs out there. To compare how the four (or ten) GCMs in a plot compare to the range of variability of all 32 GCMs, we can overlay the 32-ensemble model.</p>
<p>The 32-ensemble model is available for many but not all of the climate variables, temporal aggregations, or emission scenarios. You can see which ensemble raster series are available by searching the data catalog for ‘ens32’:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="03_time-series-viz.html#cb53-1" aria-hidden="true" tabindex="-1"></a>ensem_rasterseries_df <span class="ot">&lt;-</span> <span class="fu">ca_catalog_search</span>(<span class="st">&quot;ens32&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-2"><a href="03_time-series-viz.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ensem_rasterseries_df)</span></code></pre></div>
<pre><code>## [1] 207</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="03_time-series-viz.html#cb55-1" aria-hidden="true" tabindex="-1"></a>ensem_rasterseries_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="fu">c</span>(<span class="st">&quot;slug&quot;</span>, <span class="st">&quot;name&quot;</span>)]</span></code></pre></div>
<pre><code>##                           slug
## 1 cdd_year_ens32avg_historical
## 2      cdd_year_ens32avg_rcp45
## 3      cdd_year_ens32avg_rcp85
## 4 cddm_30y_ens32max_historical
## 5      cddm_30y_ens32max_rcp45
## 6      cddm_30y_ens32max_rcp85
##                                                                                  name
## 1            Average number of cooling degree days per year from 32 models historical
## 2                 Average number of cooling degree days per year from 32 models rcp45
## 3                 Average number of cooling degree days per year from 32 models rcp85
## 4 30 year annual average maximum length of dry spell from 32 model maximum historical
## 5      30 year annual average maximum length of dry spell from 32 model maximum rcp45
## 6      30 year annual average maximum length of dry spell from 32 model maximum rcp85</code></pre>
<p>There are 207 raster series that are derived from the 32-ensemble models. caladaptr doesn’t have convenience functions that you can string together to specify the 32-ensemble raster series, so you need to find the slug(s) by searching the data catalog (see above). To overlay the 32-ensemble of daily maximum averaged by year, we need to first download the following slugs:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="03_time-series-viz.html#cb57-1" aria-hidden="true" tabindex="-1"></a>salns_32ens_cap <span class="ot">&lt;-</span> <span class="fu">ca_loc_pt</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">121.549945</span>, <span class="fl">36.643642</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="03_time-series-viz.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_slug</span>(<span class="fu">c</span>(<span class="st">&quot;tasmax_year_ens32min_rcp45&quot;</span>, <span class="st">&quot;tasmax_year_ens32max_rcp45&quot;</span>,</span>
<span id="cb57-3"><a href="03_time-series-viz.html#cb57-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;tasmin_year_ens32min_rcp45&quot;</span>, <span class="st">&quot;tasmin_year_ens32max_rcp45&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="03_time-series-viz.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_years</span>(<span class="at">start =</span> <span class="dv">2006</span>, <span class="at">end =</span> <span class="dv">2099</span>)</span>
<span id="cb57-5"><a href="03_time-series-viz.html#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="03_time-series-viz.html#cb57-6" aria-hidden="true" tabindex="-1"></a>salns_32ens_cap <span class="sc">%&gt;%</span> <span class="fu">ca_preflight</span>()</span></code></pre></div>
<pre><code>## General issues
##  - none found
## Issues for querying values
##  - none found
## Issues for downloading rasters
##  - none found</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="03_time-series-viz.html#cb59-1" aria-hidden="true" tabindex="-1"></a>salns_32ens_tbl <span class="ot">&lt;-</span> salns_32ens_cap <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="03_time-series-viz.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_getvals_tbl</span>(<span class="at">quiet =</span> <span class="cn">TRUE</span>) </span>
<span id="cb59-3"><a href="03_time-series-viz.html#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="03_time-series-viz.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(salns_32ens_tbl)</span></code></pre></div>
<pre><code>## Rows: 376
## Columns: 5
## $ id   &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,~
## $ slug &lt;chr&gt; &quot;tasmax_year_ens32min_rcp45&quot;, &quot;tasmax_year_ens32min_rcp45&quot;, &quot;tasm~
## $ spag &lt;fct&gt; none, none, none, none, none, none, none, none, none, none, none,~
## $ dt   &lt;chr&gt; &quot;2006-12-31&quot;, &quot;2007-12-31&quot;, &quot;2008-12-31&quot;, &quot;2009-12-31&quot;, &quot;2010-12-~
## $ val  [K] 291.6819 [K], 292.1163 [K], 292.0294 [K], 292.1826 [K], 291.7250 [K~</code></pre>
<p>We need to make two changes: convert the date column from character to date, and add a column for degrees F.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="03_time-series-viz.html#cb61-1" aria-hidden="true" tabindex="-1"></a>salns_32ens_tbl <span class="ot">&lt;-</span> salns_32ens_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="03_time-series-viz.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dt =</span> <span class="fu">as.Date</span>(dt),</span>
<span id="cb61-3"><a href="03_time-series-viz.html#cb61-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp_f =</span> units<span class="sc">::</span><span class="fu">set_units</span>(val, degF))  </span>
<span id="cb61-4"><a href="03_time-series-viz.html#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="03_time-series-viz.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(salns_32ens_tbl)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##      id slug                       spag  dt          val temp_f
##   &lt;int&gt; &lt;chr&gt;                      &lt;fct&gt; &lt;date&gt;      [K] [degF]
## 1     1 tasmax_year_ens32min_rcp45 none  2006-12-31 292.   65.4
## 2     1 tasmax_year_ens32min_rcp45 none  2007-12-31 292.   66.1
## 3     1 tasmax_year_ens32min_rcp45 none  2008-12-31 292.   66.0
## 4     1 tasmax_year_ens32min_rcp45 none  2009-12-31 292.   66.3
## 5     1 tasmax_year_ens32min_rcp45 none  2010-12-31 292.   65.4
## 6     1 tasmax_year_ens32min_rcp45 none  2011-12-31 292.   66.3</code></pre>
<p><br />
</p>
<p>Now we can plot the 32-ensemble min and max of the daily maximum temperature averaged by year as individual lines:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="03_time-series-viz.html#cb63-1" aria-hidden="true" tabindex="-1"></a>ens_minmax_tbl <span class="ot">&lt;-</span> salns_32ens_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="03_time-series-viz.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(slug <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;tasmax_year_ens32min_rcp45&quot;</span>, <span class="st">&quot;tasmax_year_ens32max_rcp45&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="03_time-series-viz.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt, slug, temp_f)</span>
<span id="cb63-4"><a href="03_time-series-viz.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-5"><a href="03_time-series-viz.html#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ens_minmax_tbl, </span>
<span id="cb63-6"><a href="03_time-series-viz.html#cb63-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dt, <span class="at">y =</span> <span class="fu">as.numeric</span>(temp_f))) <span class="sc">+</span></span>
<span id="cb63-7"><a href="03_time-series-viz.html#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>slug)) <span class="sc">+</span></span>
<span id="cb63-8"><a href="03_time-series-viz.html#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;temp (F)&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p><br />
</p>
<p>To have the area between the lines show up as a shaded area, we’re going to use geom_ribbon. But geom_ribbon requires that the min and max series to be in separate columns (i.e., wide format instead of long format). Hence before we can plot it we need to reshape the data:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="03_time-series-viz.html#cb64-1" aria-hidden="true" tabindex="-1"></a>ens_minmax_wide_tbl <span class="ot">&lt;-</span> ens_minmax_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="03_time-series-viz.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> slug, </span>
<span id="cb64-3"><a href="03_time-series-viz.html#cb64-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> temp_f,</span>
<span id="cb64-4"><a href="03_time-series-viz.html#cb64-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">id_cols =</span> dt)</span>
<span id="cb64-5"><a href="03_time-series-viz.html#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="03_time-series-viz.html#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ens_minmax_wide_tbl)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   dt         tasmax_year_ens32min_rcp45 tasmax_year_ens32max_rcp45
##   &lt;date&gt;                         [degF]                     [degF]
## 1 2006-12-31                       65.4                       70.2
## 2 2007-12-31                       66.1                       70.2
## 3 2008-12-31                       66.0                       69.7
## 4 2009-12-31                       66.3                       70.8
## 5 2010-12-31                       65.4                       69.8
## 6 2011-12-31                       66.3                       71.0</code></pre>
<p><br />
</p>
<p>Now we can plot the area between the lines:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="03_time-series-viz.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ens_minmax_wide_tbl, <span class="fu">aes</span>(<span class="at">x =</span> dt)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="03_time-series-viz.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">as.numeric</span>(tasmax_year_ens32min_rcp45), <span class="at">ymax =</span> <span class="fu">as.numeric</span>(tasmax_year_ens32max_rcp45)), <span class="at">fill =</span> <span class="st">&quot;gray70&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/plot_ens_minmax_wide_tbl-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="03_time-series-viz.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This works also (don&#39;t convert the units)</span></span>
<span id="cb67-2"><a href="03_time-series-viz.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ens_minmax_wide_tbl, <span class="fu">aes</span>(<span class="at">x =</span> dt)) <span class="sc">+</span></span>
<span id="cb67-3"><a href="03_time-series-viz.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> tasmax_year_ens32min_rcp45, <span class="at">ymax =</span> tasmax_year_ens32max_rcp45), <span class="at">fill =</span> <span class="st">&quot;gray80&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/plot_ens_minmax_wide_tbl-2.png" width="672" /></p>
<p><br />
</p>
<p>Now we can combine our two plots. We’ll start with the geom_ribbon and then lay the data series on top.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="03_time-series-viz.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ens_minmax_wide_tbl, <span class="fu">aes</span>(<span class="at">x =</span> dt)) <span class="sc">+</span></span>
<span id="cb68-2"><a href="03_time-series-viz.html#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">as.numeric</span>(tasmax_year_ens32min_rcp45), </span>
<span id="cb68-3"><a href="03_time-series-viz.html#cb68-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fu">as.numeric</span>(tasmax_year_ens32max_rcp45)), <span class="at">fill =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb68-4"><a href="03_time-series-viz.html#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> mult_gcm_tbl, </span>
<span id="cb68-5"><a href="03_time-series-viz.html#cb68-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(dt), <span class="at">y =</span> <span class="fu">as.numeric</span>(temp_f), <span class="at">color =</span> gcm)) <span class="sc">+</span></span>
<span id="cb68-6"><a href="03_time-series-viz.html#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted Maximum Daily Temperature Averaged by Year&quot;</span>,</span>
<span id="cb68-7"><a href="03_time-series-viz.html#cb68-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Location: Salinas, CA. Emissions scenario: RCP4.5. Shaded background = 32-GCM ensemble&quot;</span>,</span>
<span id="cb68-8"><a href="03_time-series-viz.html#cb68-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;temp (F)&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/glimpse_salns_degf_tbl-1.png" width="672" /></p>
</div>
<div id="visualize-variability-with-histograms" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Visualize Variability with Histograms<a href="03_time-series-viz.html#visualize-variability-with-histograms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Some climate variables like precipitation don’t have a strong increasing or decreasing trend, but may see higher variability. Histograms are a good way to visualize distribution.</p>
<p><em>Coming soon…</em></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="02_api-requests.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="04_metrics-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https\://github.com/ucanr-igis/ca_cookbook/edit/master/03_time-series-viz.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https\://github.com/ucanr-igis/ca_cookbook/edit/master/03_time-series-viz.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none",
"toc_depth": 2
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
