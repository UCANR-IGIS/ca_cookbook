<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 AgroClimate Metrics | Cooking with Cal-Adapt Climate Data in R</title>
  <meta name="description" content="Chapter 5 AgroClimate Metrics | Cooking with Cal-Adapt Climate Data in R" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 AgroClimate Metrics | Cooking with Cal-Adapt Climate Data in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://ucanr-igis.github.io/ca_cookbook//./images/cookbook-cover_640x480.jpg" />
  
  <meta name="github-repo" content="ucanr-igis/ca_cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 AgroClimate Metrics | Cooking with Cal-Adapt Climate Data in R" />
  
  
  <meta name="twitter:image" content="https://ucanr-igis.github.io/ca_cookbook//./images/cookbook-cover_640x480.jpg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="04_metrics-methods.html"/>
<link rel="next" href="06_degday.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.0.9000/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.0.9000/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Cooking with Cal-Adapt</strong></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#general-workflow"><i class="fa fa-check"></i><b>1.1</b> General Workflow<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#using-climate-data-wisely"><i class="fa fa-check"></i><b>1.2</b> Using Climate Data Wisely<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#video-overviews"><i class="fa fa-check"></i><b>1.3</b> Video Overviews<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02_api-requests.html"><a href="02_api-requests.html"><i class="fa fa-check"></i><b>2</b> API Requests<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="02_api-requests.html"><a href="02_api-requests.html#constructing-cal-adapt-api-requests"><i class="fa fa-check"></i><b>2.1</b> Constructing Cal-Adapt API Requests<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="02_api-requests.html"><a href="02_api-requests.html#checking-an-api-request"><i class="fa fa-check"></i><b>2.2</b> Checking an API Request<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="02_api-requests.html"><a href="02_api-requests.html#locations-of-interest"><i class="fa fa-check"></i><b>2.3</b> Locations of Interest<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="02_api-requests.html"><a href="02_api-requests.html#longitude-latitude-coordinates"><i class="fa fa-check"></i><b>2.3.1</b> Longitude-Latitude Coordinates<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="02_api-requests.html"><a href="02_api-requests.html#simple-feature-data-frame"><i class="fa fa-check"></i><b>2.3.2</b> Simple Feature Data Frame<span></span></a></li>
<li class="chapter" data-level="2.3.3" data-path="02_api-requests.html"><a href="02_api-requests.html#preset-area-of-interest"><i class="fa fa-check"></i><b>2.3.3</b> Preset Area of Interest<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html"><i class="fa fa-check"></i><b>3</b> Time-Series Plots<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#load-packages"><i class="fa fa-check"></i><b>3.1</b> Load Packages<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#time-series-plots-1"><i class="fa fa-check"></i><b>3.2</b> Time Series Plots<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#fetch-some-data"><i class="fa fa-check"></i><b>3.2.1</b> Fetch Some Data<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#plot-1.-single-climate-variable-single-rcp"><i class="fa fa-check"></i><b>3.2.2</b> Plot 1. Single Climate Variable &amp; Single RCP<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#multiple-emissions-scenarios"><i class="fa fa-check"></i><b>3.3</b> Multiple Emissions Scenarios<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#overlay-a-trend-line"><i class="fa fa-check"></i><b>3.4</b> Overlay a Trend Line<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#historic-and-future-data-together"><i class="fa fa-check"></i><b>3.5</b> Historic and Future Data Together<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#overlay-a-32-model-ensemble"><i class="fa fa-check"></i><b>3.6</b> Overlay a 32-model Ensemble<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="03_time-series-viz.html"><a href="03_time-series-viz.html#visualize-variability-with-histograms"><i class="fa fa-check"></i><b>3.7</b> Visualize Variability with Histograms<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html"><i class="fa fa-check"></i><b>4</b> Methods for Computing Climate Metrics<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#load-packages-1"><i class="fa fa-check"></i><b>4.1</b> Load packages<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#fetch-some-sample-data"><i class="fa fa-check"></i><b>4.2</b> Fetch Some Sample Data<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#time-slicing"><i class="fa fa-check"></i><b>4.3</b> Time Slicing<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#daily-climate-metrics"><i class="fa fa-check"></i><b>4.4</b> Daily Climate Metrics<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#diurnal-temperature-range"><i class="fa fa-check"></i><b>4.5</b> Diurnal Temperature Range<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#daily-threshhold-events"><i class="fa fa-check"></i><b>4.6</b> Daily Threshhold Events<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="04_metrics-methods.html"><a href="04_metrics-methods.html#counting-consecutive-events"><i class="fa fa-check"></i><b>4.7</b> Counting Consecutive Events<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html"><i class="fa fa-check"></i><b>5</b> AgroClimate Metrics<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#load-packages-2"><i class="fa fa-check"></i><b>5.1</b> Load Packages<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#fetch-some-data-1"><i class="fa fa-check"></i><b>5.2</b> Fetch Some Data<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#growing-degree-days"><i class="fa fa-check"></i><b>5.3</b> Growing Degree Days<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#chill-accumulation"><i class="fa fa-check"></i><b>5.4</b> Chill Accumulation<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#frost-days"><i class="fa fa-check"></i><b>5.5</b> Frost Days<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#last-spring-and-first-fall-freeze"><i class="fa fa-check"></i><b>5.6</b> Last Spring and First Fall Freeze<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#freeze-free-season"><i class="fa fa-check"></i><b>5.7</b> Freeze-Free Season<span></span></a></li>
<li class="chapter" data-level="5.8" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#tropical-nights-and-hot-days"><i class="fa fa-check"></i><b>5.8</b> Tropical Nights and Hot Days<span></span></a></li>
<li class="chapter" data-level="5.9" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#extreme-heat-days"><i class="fa fa-check"></i><b>5.9</b> Extreme Heat Days<span></span></a></li>
<li class="chapter" data-level="5.10" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#heatwaves"><i class="fa fa-check"></i><b>5.10</b> Heatwaves<span></span></a></li>
<li class="chapter" data-level="5.11" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#diurnal-temperature-range-1"><i class="fa fa-check"></i><b>5.11</b> Diurnal Temperature Range<span></span></a></li>
<li class="chapter" data-level="5.12" data-path="05_agroclimate-metrics.html"><a href="05_agroclimate-metrics.html#reference-evapotranspiration"><i class="fa fa-check"></i><b>5.12</b> Reference Evapotranspiration<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06_degday.html"><a href="06_degday.html"><i class="fa fa-check"></i><b>6</b> Degree Days<span></span></a></li>
<li class="chapter" data-level="7" data-path="07_joining-other-data.html"><a href="07_joining-other-data.html"><i class="fa fa-check"></i><b>7</b> Joining Other Tables<span></span></a></li>
<li class="chapter" data-level="8" data-path="08_raster-analyses.html"><a href="08_raster-analyses.html"><i class="fa fa-check"></i><b>8</b> Raster Operations<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="08_raster-analyses.html"><a href="08_raster-analyses.html#load-packages-3"><i class="fa fa-check"></i><b>8.1</b> Load Packages<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="08_raster-analyses.html"><a href="08_raster-analyses.html#fetch-tifs"><i class="fa fa-check"></i><b>8.2</b> Fetch TIFs<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="08_raster-analyses.html"><a href="08_raster-analyses.html#import-tifs-in-r"><i class="fa fa-check"></i><b>8.3</b> Import TIFs in R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09_shiny.html"><a href="09_shiny.html"><i class="fa fa-check"></i><b>9</b> Shiny Apps<span></span></a></li>
<li class="chapter" data-level="10" data-path="99_references.html"><a href="99_references.html"><i class="fa fa-check"></i><b>10</b> References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cooking with Cal-Adapt Climate Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="agroclimate-metrics" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> AgroClimate Metrics<a href="05_agroclimate-metrics.html#agroclimate-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><span class="citation"><a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al.</a> (<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">2022</a>)</span> identify a dozen agroclimate metrics derived 100% from weather data and provide physiologically relevant information for growers. This chapter provides R code to compute most of these agroclimate metrics using historic observed data from Cal-Adapt.</p>
<div id="load-packages-2" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Load Packages<a href="05_agroclimate-metrics.html#load-packages-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, we start by loading a bunch of packages into memory and specifying our preferences for conflicting function names:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="05_agroclimate-metrics.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caladaptr)</span>
<span id="cb125-2"><a href="05_agroclimate-metrics.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(units)</span>
<span id="cb125-3"><a href="05_agroclimate-metrics.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb125-4"><a href="05_agroclimate-metrics.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb125-5"><a href="05_agroclimate-metrics.html#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb125-6"><a href="05_agroclimate-metrics.html#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb125-7"><a href="05_agroclimate-metrics.html#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<p>Set conflicted preferences:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="05_agroclimate-metrics.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb126-2"><a href="05_agroclimate-metrics.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">&quot;filter&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-3"><a href="05_agroclimate-metrics.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">&quot;count&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-4"><a href="05_agroclimate-metrics.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">&quot;select&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="fetch-some-data-1" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Fetch Some Data<a href="05_agroclimate-metrics.html#fetch-some-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To compute agroclimate metrics, we’ll first get 20 years of observed data from the gridMet dataset for a location in Colusa County in the Sacramento Valley.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="05_agroclimate-metrics.html#cb127-1" aria-hidden="true" tabindex="-1"></a>colusa_cap <span class="ot">&lt;-</span> <span class="fu">ca_loc_pt</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">122.159304</span>, <span class="fl">39.289291</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="05_agroclimate-metrics.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_slug</span>(<span class="fu">c</span>(<span class="st">&quot;tmmn_day_gridmet&quot;</span>, <span class="st">&quot;tmmx_day_gridmet&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="05_agroclimate-metrics.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_years</span>(<span class="at">start =</span> <span class="dv">2000</span>, <span class="at">end =</span> <span class="dv">2020</span>) </span>
<span id="cb127-4"><a href="05_agroclimate-metrics.html#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="05_agroclimate-metrics.html#cb127-5" aria-hidden="true" tabindex="-1"></a>colusa_cap</span></code></pre></div>
<pre><code>## Cal-Adapt API Request
## Location(s): 
##   x: -122.159
##   y: 39.289
## Slug(s): tmmn_day_gridmet, tmmx_day_gridmet
## Dates: 2000-01-01 to 2020-12-31
## </code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="05_agroclimate-metrics.html#cb129-1" aria-hidden="true" tabindex="-1"></a>colusa_cap <span class="sc">%&gt;%</span> <span class="fu">ca_preflight</span>()</span></code></pre></div>
<pre><code>## General issues
##  - none found
## Issues for querying values
##  - none found
## Issues for downloading rasters
##  - none found</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="05_agroclimate-metrics.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(colusa_cap)</span></code></pre></div>
<div id="htmlwidget-ff964c7ab6f25e891c86" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-ff964c7ab6f25e891c86">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.NatGeoWorldMap",null,"Esri.NatGeoWorldMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircleMarkers","args":[39.289291,-122.159304,8.94427190999916,"X1","Query Location(s)",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":"#FF0000","fillOpacity":0.8},null,null,"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>id<\/nobr><\/td><td align=\"right\"><nobr>1<\/nobr><\/td><\/tr><\/table><\/div>",null,"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[[],"Query Location(s)",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[39.289291,39.289291],"lng":[-122.159304,-122.159304]},"fitBounds":[38.789291,-122.659304,39.789291,-121.659304,[]]},"evals":[],"jsHooks":[]}</script>
<p><br />
</p>
<p>Next we fetch the data. While we’re at it, we’ll add columns for the climate variable (based on the slug), year, and temperature in Fahrenheit:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="05_agroclimate-metrics.html#cb132-1" aria-hidden="true" tabindex="-1"></a>colusa_tbl <span class="ot">&lt;-</span> colusa_cap <span class="sc">%&gt;%</span> </span>
<span id="cb132-2"><a href="05_agroclimate-metrics.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_getvals_tbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-3"><a href="05_agroclimate-metrics.html#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dt =</span> <span class="fu">as.Date</span>(dt),</span>
<span id="cb132-4"><a href="05_agroclimate-metrics.html#cb132-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">year</span>(<span class="fu">as.Date</span>(dt)),</span>
<span id="cb132-5"><a href="05_agroclimate-metrics.html#cb132-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">cvar =</span> <span class="fu">substr</span>(slug, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb132-6"><a href="05_agroclimate-metrics.html#cb132-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp_f =</span> units<span class="sc">::</span><span class="fu">set_units</span>(val, degF)) <span class="sc">%&gt;%</span> </span>
<span id="cb132-7"><a href="05_agroclimate-metrics.html#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, dt, cvar, temp_f)</span>
<span id="cb132-8"><a href="05_agroclimate-metrics.html#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="05_agroclimate-metrics.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(colusa_tbl)</span></code></pre></div>
<pre><code>## Rows: 15,342
## Columns: 4
## $ year   &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 200~
## $ dt     &lt;date&gt; 2000-01-01, 2000-01-02, 2000-01-03, 2000-01-04, 2000-01-05, 20~
## $ cvar   &lt;chr&gt; &quot;tmmn&quot;, &quot;tmmn&quot;, &quot;tmmn&quot;, &quot;tmmn&quot;, &quot;tmmn&quot;, &quot;tmmn&quot;, &quot;tmmn&quot;, &quot;tmmn&quot;,~
## $ temp_f [degF] 32.45 [degF], 30.11 [degF], 32.09 [degF], 39.11 [degF], 32.27 ~</code></pre>
</div>
<div id="growing-degree-days" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Growing Degree Days<a href="05_agroclimate-metrics.html#growing-degree-days" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Growing Degree Days (GDD) are a measure of accumulated heat starting from a specific date / event. You may wonder - what’s the point of tracking accumulated heat, given that it cools down every night? The answer is because many plants seem to keep track of accumulated heat units. Research has shown that many phenological events, like the emergence of fruit, are strongly correlated with accumulated heat, also known as thermal time. Insect phenology is likewise strongly correlated with heat units.</p>
<p>There are a few ways of computing GDD. <span class="citation"><a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al.</a> (<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">2022</a>)</span> recommend the simple average method with a base temperature of 10 °C:</p>
<center>
<span class="math inline">\(GDD = (temp_{max} - temp_{min}) / 2 - temp_{base}\)</span>
</center>
<p>Negative GDD values are not biologically meaningful (i.e., plant development generally doesn’t go backwards), so negative GDD values are generally converted to 0 (i.e., Method 1 described by <span class="citation"><a href="99_references.html#ref-mcmaster_growing_1997" role="doc-biblioref">McMaster and Wilhelm</a> (<a href="99_references.html#ref-mcmaster_growing_1997" role="doc-biblioref">1997</a>)</span>).</p>
<p>Computing daily GDD is fairly straight-forward. We just have to remember to zero-out negative GDD values:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="05_agroclimate-metrics.html#cb134-1" aria-hidden="true" tabindex="-1"></a>(tbase_c <span class="ot">&lt;-</span> <span class="fu">set_units</span>(<span class="dv">10</span>, degC))                           <span class="do">## base temp</span></span></code></pre></div>
<pre><code>## 10 [°C]</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="05_agroclimate-metrics.html#cb136-1" aria-hidden="true" tabindex="-1"></a>colusa_gdd_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb136-2"><a href="05_agroclimate-metrics.html#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_c =</span> <span class="fu">set_units</span>(temp_f, degC)) <span class="sc">%&gt;%</span>             <span class="do">## create a degC column</span></span>
<span id="cb136-3"><a href="05_agroclimate-metrics.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(year, dt),                       <span class="do">## make min and max temps separate colums</span></span>
<span id="cb136-4"><a href="05_agroclimate-metrics.html#cb136-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> cvar, </span>
<span id="cb136-5"><a href="05_agroclimate-metrics.html#cb136-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> temp_c) <span class="sc">%&gt;%</span> </span>
<span id="cb136-6"><a href="05_agroclimate-metrics.html#cb136-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdd =</span> <span class="fu">as.numeric</span>(((tmmx<span class="sc">+</span>tmmn)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> tbase_c)) <span class="sc">%&gt;%</span>  <span class="do">## compute gdd as a numeric value</span></span>
<span id="cb136-7"><a href="05_agroclimate-metrics.html#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdd =</span> <span class="fu">if_else</span>(gdd <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, gdd))                   <span class="do">## zero-out negative values</span></span>
<span id="cb136-8"><a href="05_agroclimate-metrics.html#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="05_agroclimate-metrics.html#cb136-9" aria-hidden="true" tabindex="-1"></a>colusa_gdd_tbl <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##    year dt            tmmn  tmmx   gdd
##   &lt;dbl&gt; &lt;date&gt;        [°C]  [°C] &lt;dbl&gt;
## 1  2000 2000-01-01  0.250  12.7      0
## 2  2000 2000-01-02 -1.05   12.2      0
## 3  2000 2000-01-03  0.0500 14.2      0
## 4  2000 2000-01-04  3.95    9.65     0
## 5  2000 2000-01-05  0.150  14.2      0
## 6  2000 2000-01-06 -1.35   12.6      0</code></pre>
<p><br />
</p>
<p>Applying GDD to predict crop development requires 1) a start date (also known as a biofix date), and 2) a crop phenology table. These are not shown here, but are not hard to apply (for an example see the <a href="https://ucanr-igis.shinyapps.io/pist_gdd/" target="_blank" rel="noopener">Pistachio Nut Development Decision Support</a> tool).</p>
<p><br />
</p>
</div>
<div id="chill-accumulation" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Chill Accumulation<a href="05_agroclimate-metrics.html#chill-accumulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Chill accumulation is similar to growing degree days, but for cold. In other words, there are a few phenological events that appear to be strongly correlated with the accumulated amount of chill. An example of this is flowering for many tree crops. Apparently, the trees keep an internal ledger of how cold its been during the winter, and for how long. They use this internal record use to decide when it’s time to come out of their winter dormancy and start flowering. This mechanism probably evolved to help them avoid frost damage.</p>
<p>Researchers have looked at a number of ways to measure accumulated chill, and the one that does the best job at predicting phenology events is called Chill Portions (CP) <span class="citation">(<a href="99_references.html#ref-luedeling_global_2011" role="doc-biblioref">Luedeling and Brown 2011</a>)</span>. The calculations are a bit complicated, but fortunately there’s a R-package that will compute chill portions. For more info, see <a href="https://ucanr-igis.github.io/caladaptr-res/notebooks/chill.nb.html" target="_blank" rel="noopener">here</a>.</p>
<p><br />
</p>
</div>
<div id="frost-days" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Frost Days<a href="05_agroclimate-metrics.html#frost-days" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Frost Days (FD) are the number of days per year with minimum temperatures (Tn) ≤ 0 °C <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>. They can be computed with:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="05_agroclimate-metrics.html#cb138-1" aria-hidden="true" tabindex="-1"></a>colusa_fd_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb138-2"><a href="05_agroclimate-metrics.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tmmn&quot;</span>, temp_f <span class="sc">&lt;=</span> <span class="fu">set_units</span>(<span class="dv">0</span>, degC)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-3"><a href="05_agroclimate-metrics.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb138-4"><a href="05_agroclimate-metrics.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">fd =</span> <span class="fu">n</span>())</span>
<span id="cb138-5"><a href="05_agroclimate-metrics.html#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="05_agroclimate-metrics.html#cb138-6" aria-hidden="true" tabindex="-1"></a>colusa_fd_tbl</span></code></pre></div>
<pre><code>## # A tibble: 21 x 2
##     year    fd
##    &lt;dbl&gt; &lt;int&gt;
##  1  2000     9
##  2  2001    14
##  3  2002    16
##  4  2003    10
##  5  2004     9
##  6  2005     5
##  7  2006    11
##  8  2007    23
##  9  2008     8
## 10  2009    24
## # ... with 11 more rows</code></pre>
<p><br />
</p>
</div>
<div id="last-spring-and-first-fall-freeze" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Last Spring and First Fall Freeze<a href="05_agroclimate-metrics.html#last-spring-and-first-fall-freeze" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Last Spring Freeze (LSF) is defined as the last day of the calendar year prior to 30 June with a Tn ≤ 0 °C. Conversely the First Fall Freeze (FFF) is defined as the first day of the calendar year commencing 1 July with Tn ≤ 0 °C <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>.</p>
<p>We can find the last freeze date by chaining together dplyr expressions that i) keep only ‘freeze days’ from January through June, ii) group the freeze days by year, and iii) taking the max date for each group:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="05_agroclimate-metrics.html#cb140-1" aria-hidden="true" tabindex="-1"></a>colusa_lf_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb140-2"><a href="05_agroclimate-metrics.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tmmn&quot;</span>, <span class="fu">month</span>(dt) <span class="sc">&lt;=</span> <span class="dv">6</span>, temp_f <span class="sc">&lt;=</span> <span class="fu">set_units</span>(<span class="dv">32</span>, degF)) <span class="sc">%&gt;%</span> </span>
<span id="cb140-3"><a href="05_agroclimate-metrics.html#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="05_agroclimate-metrics.html#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">lf =</span> <span class="fu">max</span>(dt))</span>
<span id="cb140-5"><a href="05_agroclimate-metrics.html#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="05_agroclimate-metrics.html#cb140-6" aria-hidden="true" tabindex="-1"></a>colusa_lf_tbl</span></code></pre></div>
<pre><code>## # A tibble: 20 x 2
##     year lf        
##    &lt;dbl&gt; &lt;date&gt;    
##  1  2000 2000-01-28
##  2  2001 2001-04-10
##  3  2002 2002-03-18
##  4  2003 2003-02-08
##  5  2004 2004-01-05
##  6  2005 2005-01-30
##  7  2006 2006-02-20
##  8  2007 2007-03-01
##  9  2008 2008-04-20
## 10  2009 2009-03-23
## 11  2011 2011-02-28
## 12  2012 2012-03-23
## 13  2013 2013-02-26
## 14  2014 2014-02-04
## 15  2015 2015-01-03
## 16  2016 2016-01-01
## 17  2017 2017-02-28
## 18  2018 2018-03-05
## 19  2019 2019-01-04
## 20  2020 2020-01-04</code></pre>
<p><br />
</p>
<p>Similarly, we can find the first fall freeze by keeping only dates from July - December where the temperature dipped below freezing, then taking the minimum date for each year:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="05_agroclimate-metrics.html#cb142-1" aria-hidden="true" tabindex="-1"></a>colusa_fff_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="05_agroclimate-metrics.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tmmn&quot;</span>, <span class="fu">month</span>(dt) <span class="sc">&gt;=</span> <span class="dv">7</span>, temp_f <span class="sc">&lt;=</span> <span class="fu">set_units</span>(<span class="dv">32</span>, degF)) <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="05_agroclimate-metrics.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb142-4"><a href="05_agroclimate-metrics.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">fff =</span> <span class="fu">min</span>(dt))</span>
<span id="cb142-5"><a href="05_agroclimate-metrics.html#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="05_agroclimate-metrics.html#cb142-6" aria-hidden="true" tabindex="-1"></a>colusa_fff_tbl</span></code></pre></div>
<pre><code>## # A tibble: 20 x 2
##     year fff       
##    &lt;dbl&gt; &lt;date&gt;    
##  1  2000 2000-11-12
##  2  2001 2001-11-27
##  3  2002 2002-12-23
##  4  2003 2003-11-22
##  5  2004 2004-11-29
##  6  2005 2005-12-04
##  7  2006 2006-11-28
##  8  2007 2007-12-01
##  9  2008 2008-12-10
## 10  2009 2009-11-13
## 11  2010 2010-11-23
## 12  2011 2011-12-04
## 13  2012 2012-12-15
## 14  2013 2013-11-24
## 15  2015 2015-11-25
## 16  2016 2016-12-06
## 17  2017 2017-12-11
## 18  2018 2018-11-14
## 19  2019 2019-11-24
## 20  2020 2020-11-10</code></pre>
<p><br />
</p>
</div>
<div id="freeze-free-season" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Freeze-Free Season<a href="05_agroclimate-metrics.html#freeze-free-season" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Freeze-Free Season (FFS) is calculated as the difference between the LSF and FFF (FFF [minus] LSF) <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>. Since we already calculated LSF and FFF, computing the Freeze-Free Season can be done with a simple table join:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="05_agroclimate-metrics.html#cb144-1" aria-hidden="true" tabindex="-1"></a>colusa_lf_fff_tbl <span class="ot">&lt;-</span> colusa_lf_tbl <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(colusa_fff_tbl, <span class="at">by =</span> <span class="st">&quot;year&quot;</span>)</span>
<span id="cb144-2"><a href="05_agroclimate-metrics.html#cb144-2" aria-hidden="true" tabindex="-1"></a>colusa_lf_fff_tbl <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##    year lf         fff       
##   &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;    
## 1  2000 2000-01-28 2000-11-12
## 2  2001 2001-04-10 2001-11-27
## 3  2002 2002-03-18 2002-12-23
## 4  2003 2003-02-08 2003-11-22
## 5  2004 2004-01-05 2004-11-29
## 6  2005 2005-01-30 2005-12-04</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="05_agroclimate-metrics.html#cb146-1" aria-hidden="true" tabindex="-1"></a>colusa_lf_fff_ffs_tbl <span class="ot">&lt;-</span> colusa_lf_fff_tbl <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ffs =</span> fff <span class="sc">-</span> lf)</span>
<span id="cb146-2"><a href="05_agroclimate-metrics.html#cb146-2" aria-hidden="true" tabindex="-1"></a>colusa_lf_fff_ffs_tbl</span></code></pre></div>
<pre><code>## # A tibble: 20 x 4
##     year lf         fff        ffs     
##    &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;drtn&gt;  
##  1  2000 2000-01-28 2000-11-12 289 days
##  2  2001 2001-04-10 2001-11-27 231 days
##  3  2002 2002-03-18 2002-12-23 280 days
##  4  2003 2003-02-08 2003-11-22 287 days
##  5  2004 2004-01-05 2004-11-29 329 days
##  6  2005 2005-01-30 2005-12-04 308 days
##  7  2006 2006-02-20 2006-11-28 281 days
##  8  2007 2007-03-01 2007-12-01 275 days
##  9  2008 2008-04-20 2008-12-10 234 days
## 10  2009 2009-03-23 2009-11-13 235 days
## 11  2011 2011-02-28 2011-12-04 279 days
## 12  2012 2012-03-23 2012-12-15 267 days
## 13  2013 2013-02-26 2013-11-24 271 days
## 14  2014 2014-02-04 NA          NA days
## 15  2015 2015-01-03 2015-11-25 326 days
## 16  2016 2016-01-01 2016-12-06 340 days
## 17  2017 2017-02-28 2017-12-11 286 days
## 18  2018 2018-03-05 2018-11-14 254 days
## 19  2019 2019-01-04 2019-11-24 324 days
## 20  2020 2020-01-04 2020-11-10 311 days</code></pre>
<p><br />
</p>
</div>
<div id="tropical-nights-and-hot-days" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Tropical Nights and Hot Days<a href="05_agroclimate-metrics.html#tropical-nights-and-hot-days" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tropical Nights (TRN) are calculated as the number of nights per year with Tn &gt; 20 °C (68 °F) <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>. This can be computed with:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="05_agroclimate-metrics.html#cb148-1" aria-hidden="true" tabindex="-1"></a>colusa_tn_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb148-2"><a href="05_agroclimate-metrics.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tmmn&quot;</span>, temp_f <span class="sc">&gt;</span> <span class="fu">set_units</span>(<span class="dv">20</span>, degC)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-3"><a href="05_agroclimate-metrics.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb148-4"><a href="05_agroclimate-metrics.html#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tn =</span> <span class="fu">n</span>())</span>
<span id="cb148-5"><a href="05_agroclimate-metrics.html#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="05_agroclimate-metrics.html#cb148-6" aria-hidden="true" tabindex="-1"></a>colusa_tn_tbl</span></code></pre></div>
<pre><code>## # A tibble: 18 x 2
##     year    tn
##    &lt;dbl&gt; &lt;int&gt;
##  1  2000    10
##  2  2001     8
##  3  2002     3
##  4  2003    10
##  5  2004     1
##  6  2005     4
##  7  2006    12
##  8  2007     6
##  9  2008     6
## 10  2009     3
## 11  2011     2
## 12  2012     3
## 13  2013    13
## 14  2015    10
## 15  2017    15
## 16  2018     2
## 17  2019     3
## 18  2020    13</code></pre>
<p><br />
</p>
<p>Hot Days (HD) are defined as when Tx &gt; 38 °C <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>. The number of hot days per year can be computed with:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="05_agroclimate-metrics.html#cb150-1" aria-hidden="true" tabindex="-1"></a>colusa_hd_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb150-2"><a href="05_agroclimate-metrics.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tmmx&quot;</span>, temp_f <span class="sc">&gt;</span> <span class="fu">set_units</span>(<span class="dv">38</span>, degC)) <span class="sc">%&gt;%</span> </span>
<span id="cb150-3"><a href="05_agroclimate-metrics.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb150-4"><a href="05_agroclimate-metrics.html#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hd =</span> <span class="fu">n</span>())</span>
<span id="cb150-5"><a href="05_agroclimate-metrics.html#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="05_agroclimate-metrics.html#cb150-6" aria-hidden="true" tabindex="-1"></a>colusa_hd_tbl</span></code></pre></div>
<pre><code>## # A tibble: 21 x 2
##     year    hd
##    &lt;dbl&gt; &lt;int&gt;
##  1  2000    15
##  2  2001    17
##  3  2002    15
##  4  2003    14
##  5  2004     7
##  6  2005    20
##  7  2006    20
##  8  2007     8
##  9  2008    21
## 10  2009    26
## # ... with 11 more rows</code></pre>
<p><br />
</p>
</div>
<div id="extreme-heat-days" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Extreme Heat Days<a href="05_agroclimate-metrics.html#extreme-heat-days" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Extreme Heat Days (EHD) are the number of days per year with Tx &gt;98th percentile of summer (June-August)
Tx for the 1981–2010 period <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>. This is similar to HD, but with a threshold value based on the historic record. We can compute the 98th percentile of daily summertime highs with:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="05_agroclimate-metrics.html#cb152-1" aria-hidden="true" tabindex="-1"></a>colusa_ehd_thresh <span class="ot">&lt;-</span> <span class="fu">ca_loc_pt</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">122.159304</span>, <span class="fl">39.289291</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="05_agroclimate-metrics.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_slug</span>(<span class="st">&quot;tmmx_day_gridmet&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="05_agroclimate-metrics.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_years</span>(<span class="at">start =</span> <span class="dv">1981</span>, <span class="at">end =</span> <span class="dv">2010</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb152-4"><a href="05_agroclimate-metrics.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ca_getvals_tbl</span>(<span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb152-5"><a href="05_agroclimate-metrics.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">month</span>(<span class="fu">as.Date</span>(dt)) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb152-6"><a href="05_agroclimate-metrics.html#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(val) <span class="sc">%&gt;%</span> </span>
<span id="cb152-7"><a href="05_agroclimate-metrics.html#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(<span class="fl">0.98</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb152-8"><a href="05_agroclimate-metrics.html#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_units</span>(degF)</span>
<span id="cb152-9"><a href="05_agroclimate-metrics.html#cb152-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-10"><a href="05_agroclimate-metrics.html#cb152-10" aria-hidden="true" tabindex="-1"></a>colusa_ehd_thresh</span></code></pre></div>
<pre><code>## 106.2176 [degF]</code></pre>
<p><br />
</p>
<p>Once we have that threshold, we can compute Extreme Heat Days with:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="05_agroclimate-metrics.html#cb154-1" aria-hidden="true" tabindex="-1"></a>colusa_ehd_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb154-2"><a href="05_agroclimate-metrics.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tmmx&quot;</span>, temp_f <span class="sc">&gt;</span> colusa_ehd_thresh) <span class="sc">%&gt;%</span> </span>
<span id="cb154-3"><a href="05_agroclimate-metrics.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb154-4"><a href="05_agroclimate-metrics.html#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hd =</span> <span class="fu">n</span>())</span>
<span id="cb154-5"><a href="05_agroclimate-metrics.html#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="05_agroclimate-metrics.html#cb154-6" aria-hidden="true" tabindex="-1"></a>colusa_ehd_tbl</span></code></pre></div>
<pre><code>## # A tibble: 17 x 2
##     year    hd
##    &lt;dbl&gt; &lt;int&gt;
##  1  2001     1
##  2  2002     1
##  3  2003     4
##  4  2005     2
##  5  2006     7
##  6  2007     1
##  7  2008     4
##  8  2009     3
##  9  2010     1
## 10  2012    10
## 11  2013    12
## 12  2014     2
## 13  2015     1
## 14  2017     8
## 15  2018     1
## 16  2019     1
## 17  2020     3</code></pre>
<p><br />
</p>
</div>
<div id="heatwaves" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> Heatwaves<a href="05_agroclimate-metrics.html#heatwaves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Heatwave events (HW) are defined as 3+ consecutive days with Tx &gt; 98th percentile of 1981–2010 summer Tx (as in EHD) <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>. Using the technique described in <a href="04_metrics-methods.html#counting-consecutive-events">Chapter 4 - Counting Consecutive Events</a>, we can compute the number of heatwaves per year.</p>
<ol style="list-style-type: decimal">
<li>Add a column for extreme heat day, then create a grouped tibble (by year):</li>
</ol>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="05_agroclimate-metrics.html#cb156-1" aria-hidden="true" tabindex="-1"></a>colusa_grpd_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb156-2"><a href="05_agroclimate-metrics.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cvar <span class="sc">==</span> <span class="st">&quot;tmmx&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-3"><a href="05_agroclimate-metrics.html#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ehd =</span> temp_f <span class="sc">&gt;</span> colusa_ehd_thresh) <span class="sc">%&gt;%</span></span>
<span id="cb156-4"><a href="05_agroclimate-metrics.html#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb156-5"><a href="05_agroclimate-metrics.html#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dt)</span>
<span id="cb156-6"><a href="05_agroclimate-metrics.html#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="05_agroclimate-metrics.html#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(colusa_grpd_tbl)</span></code></pre></div>
<pre><code>## Rows: 7,671
## Columns: 5
## Groups: year [21]
## $ year   &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 200~
## $ dt     &lt;date&gt; 2000-01-01, 2000-01-02, 2000-01-03, 2000-01-04, 2000-01-05, 20~
## $ cvar   &lt;chr&gt; &quot;tmmx&quot;, &quot;tmmx&quot;, &quot;tmmx&quot;, &quot;tmmx&quot;, &quot;tmmx&quot;, &quot;tmmx&quot;, &quot;tmmx&quot;, &quot;tmmx&quot;,~
## $ temp_f [degF] 54.95 [degF], 53.87 [degF], 57.65 [degF], 49.37 [degF], 57.47 ~
## $ ehd    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, ~</code></pre>
<p><br />
</p>
<ol start="2" style="list-style-type: decimal">
<li>Create a function that we can pass to <code>group_modify()</code>, will return the number of heatwaves per group (year):</li>
</ol>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="05_agroclimate-metrics.html#cb158-1" aria-hidden="true" tabindex="-1"></a>num_hw <span class="ot">&lt;-</span> <span class="cf">function</span>(data_tbl, key_tbl, <span class="at">num_days =</span> <span class="dv">3</span>) {</span>
<span id="cb158-2"><a href="05_agroclimate-metrics.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  rle_lst <span class="ot">&lt;-</span> <span class="fu">rle</span>(data_tbl<span class="sc">$</span>ehd)</span>
<span id="cb158-3"><a href="05_agroclimate-metrics.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">num_hw =</span> <span class="fu">sum</span>(rle_lst<span class="sc">$</span>values <span class="sc">&amp;</span> rle_lst<span class="sc">$</span>lengths <span class="sc">&gt;=</span> num_days))</span>
<span id="cb158-4"><a href="05_agroclimate-metrics.html#cb158-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p> </p>
<ol start="3" style="list-style-type: decimal">
<li>Apply the heatwave function to the grouped tibble:</li>
</ol>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="05_agroclimate-metrics.html#cb159-1" aria-hidden="true" tabindex="-1"></a>colusa_hw_tbl <span class="ot">&lt;-</span> colusa_grpd_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb159-2"><a href="05_agroclimate-metrics.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_modify</span>(<span class="at">.f =</span> num_hw, <span class="at">num_days =</span> <span class="dv">3</span>)</span>
<span id="cb159-3"><a href="05_agroclimate-metrics.html#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="05_agroclimate-metrics.html#cb159-4" aria-hidden="true" tabindex="-1"></a>colusa_hw_tbl</span></code></pre></div>
<pre><code>## # A tibble: 21 x 2
## # Groups:   year [21]
##     year num_hw
##    &lt;dbl&gt;  &lt;int&gt;
##  1  2000      0
##  2  2001      0
##  3  2002      0
##  4  2003      0
##  5  2004      0
##  6  2005      0
##  7  2006      1
##  8  2007      0
##  9  2008      1
## 10  2009      0
## # ... with 11 more rows</code></pre>
<p><br />
</p>
</div>
<div id="diurnal-temperature-range-1" class="section level2 hasAnchor" number="5.11">
<h2><span class="header-section-number">5.11</span> Diurnal Temperature Range<a href="05_agroclimate-metrics.html#diurnal-temperature-range-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Diurnal Temperature Range (DTR) is the difference between daily Tx and Tn <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>. Below we calculate DTR over 1 March to 1 November.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="05_agroclimate-metrics.html#cb161-1" aria-hidden="true" tabindex="-1"></a>colusa_dtr_tbl <span class="ot">&lt;-</span> colusa_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="05_agroclimate-metrics.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">month</span>(dt) <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="05_agroclimate-metrics.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(year, dt), <span class="at">names_from =</span> cvar, <span class="at">values_from =</span> temp_f) <span class="sc">%&gt;%</span> </span>
<span id="cb161-4"><a href="05_agroclimate-metrics.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dtr =</span> tmmx <span class="sc">-</span> tmmn)</span>
<span id="cb161-5"><a href="05_agroclimate-metrics.html#cb161-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-6"><a href="05_agroclimate-metrics.html#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(colusa_dtr_tbl)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##    year dt           tmmn   tmmx    dtr
##   &lt;dbl&gt; &lt;date&gt;     [degF] [degF] [degF]
## 1  2000 2000-03-01   35.7   62.7  27.0 
## 2  2000 2000-03-02   45.9   55.5   9.54
## 3  2000 2000-03-03   36.6   68.6  32.0 
## 4  2000 2000-03-04   41.1   62.1  21.1 
## 5  2000 2000-03-05   46.3   55.5   9.18
## 6  2000 2000-03-06   43.6   56.4  12.8</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="05_agroclimate-metrics.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(colusa_dtr_tbl <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.factor</span>(year)), <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y =</span> dtr)) <span class="sc">+</span> </span>
<span id="cb163-2"><a href="05_agroclimate-metrics.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb163-3"><a href="05_agroclimate-metrics.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Diurnal Temperature Range, 2000-2020&quot;</span>,</span>
<span id="cb163-4"><a href="05_agroclimate-metrics.html#cb163-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Colusa, CA&quot;</span>, </span>
<span id="cb163-5"><a href="05_agroclimate-metrics.html#cb163-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Dataset: gridMet. Temporal period: March - October&quot;</span>,</span>
<span id="cb163-6"><a href="05_agroclimate-metrics.html#cb163-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;daily temperature range&quot;</span>)</span></code></pre></div>
<p><img src="cookbook_files/figure-html/ggplot_colusa_dtr_tbl-1.png" width="672" /></p>
</div>
<div id="reference-evapotranspiration" class="section level2 hasAnchor" number="5.12">
<h2><span class="header-section-number">5.12</span> Reference Evapotranspiration<a href="05_agroclimate-metrics.html#reference-evapotranspiration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ETo is calculated following the FAO Penman–Monteith method <span class="citation">(<a href="99_references.html#ref-allen_crop_1998" role="doc-biblioref">Allen and United Nations 1998</a>)</span>. We calculate summer (June-August) average ETo for each year 1981–2020 for our analysis. ETo units are mm <span class="citation">(<a href="99_references.html#ref-parker_observed_2022" role="doc-biblioref">Parker et al. 2022</a>)</span>.</p>
<p style="font-size:150%; font-style:italic;">
More coming soon…
</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="04_metrics-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="06_degday.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https\://github.com/ucanr-igis/ca_cookbook/edit/master/05_agroclimate-metrics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https\://github.com/ucanr-igis/ca_cookbook/edit/master/05_agroclimate-metrics.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none",
"toc_depth": 2
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
